# üèîÔ∏è FSTR API ‚Äî –ü–µ—Ä–µ–≤–∞–ª—ã

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç REST API –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≥–æ—Ä–Ω—ã—Ö –ø–µ—Ä–µ–≤–∞–ª–∞—Ö. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Django + Django REST Framework + PostgreSQL.

---

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫ (Docker)

```bash
docker-compose up --build
```

–ü—Ä–æ–µ–∫—Ç –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É:  
[http://localhost:8000](http://localhost:8000)

---

## üîó –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API

- Swagger: [http://localhost:8000/swagger/](http://localhost:8000/swagger/)
- Redoc: [http://localhost:8000/redoc/](http://localhost:8000/redoc/)

## üì¶ –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

| –ú–µ—Ç–æ–¥ | URL                            | –û–ø–∏—Å–∞–Ω–∏–µ                         |
|-------|--------------------------------|----------------------------------|
| POST  | `/api/submitData/`            | –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–≤–∞–ª                 |
| GET   | `/api/submitData/<id>/`       | –ü–æ–ª—É—á–∏—Ç—å –ø–µ—Ä–µ–≤–∞–ª –ø–æ ID           |
| PATCH | `/api/submitData/<id>/`       | –ò–∑–º–µ–Ω–∏—Ç—å –ø–µ—Ä–µ–≤–∞–ª (–µ—Å–ª–∏ status=new) |
| GET   | `/api/submitData/?user__email=<email>` | –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –ø–µ—Ä–µ–≤–∞–ª—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |


## üìå –û–ø–∏—Å–∞–Ω–∏–µ API

### üì§ POST `/submitData/`

–î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–µ—Ä–µ–≤–∞–ª–µ.

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**

```json
{
  "user": {
    "email": "ivan@example.com",
    "fam": "–ò–≤–∞–Ω–æ–≤",
    "name": "–ò–≤–∞–Ω",
    "otc": "–ò–≤–∞–Ω–æ–≤–∏—á",
    "phone": "89991112233"
  },
  "coords": {
    "latitude": 45.123,
    "longitude": 37.456,
    "height": 1200
  },
  "beauty_title": "–ø–µ—Ä.",
  "title": "–ê–π-–Æ–ª—é",
  "other_titles": "–ê—é–ª—é",
  "connect": "",
  "level_winter": "1A",
  "level_summer": "1B",
  "level_autumn": "1A",
  "level_spring": "1A",
  "images": [
    {"title": "–í–∏–¥ –Ω–∞ –ø–µ—Ä–µ–≤–∞–ª", "data": "<base64 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ>"},
    {"title": "–§–æ—Ç–æ —Å–æ —Å–ø—É—Å–∫–∞", "data": "<base64 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ>"}
  ]
}
```

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**

```json
{
  "status": 200,
  "message": "–ü–µ—Ä–µ–≤–∞–ª —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω",
  "id": 42
}
```

---

### üì• GET `/submitData/<id>/`

–ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–µ—Ä–µ–≤–∞–ª–µ –ø–æ ID.

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**

```json
{
  "id": 42,
  "status": "new",
  "user": { ... },
  "coords": { ... },
  "title": "–ê–π-–Æ–ª—é",
  ...
}
```

---

### ‚úèÔ∏è PATCH `/submitData/<id>/`

–ò–∑–º–µ–Ω–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–µ—Ä–µ–≤–∞–ª–µ (–µ—Å–ª–∏ —Å—Ç–∞—Ç—É—Å ‚Äî `new`).  
**FIO, email –∏ —Ç–µ–ª–µ—Ñ–æ–Ω —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–µ–ª—å–∑—è.**

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**

```json
{
  "title": "–ê–π-–Æ–ª—é –æ–±–Ω–æ–≤–ª—ë–Ω",
  "level_summer": "1A+"
}
```

**–û—Ç–≤–µ—Ç:**

```json
{
  "state": 1,
  "message": "–ó–∞–ø–∏—Å—å —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∞"
}
```

---

### üìß GET `/submitData/?user__email=ivan@example.com`

–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–µ—Ä–µ–≤–∞–ª–æ–≤, –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –ø–æ email.

---

## üîê –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ `.env` –≤ –∫–æ—Ä–Ω–µ:

```
FSTR_DB_HOST=localhost
FSTR_DB_PORT=5432
FSTR_DB_LOGIN=postgres
FSTR_DB_PASS=yourpassword
DJANGO_SECRET_KEY=—Å–µ–∫—Ä–µ—Ç–Ω—ã–π_–∫–ª—é—á
```

---

## üß™ –¢–µ—Å—Ç—ã

```bash
python manage.py test
```
